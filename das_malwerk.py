import requests
from bs4 import BeautifulSoup
import os
from tqdm import tqdm
from pathlib import Path

def main():

    save_path = Path(os.getcwd())/"das_malwerk"
    p_url = 'https://das-malwerk.herokuapp.com/'
    r = requests.get(p_url)
    doc = BeautifulSoup(r.text, 'html.parser')
    elements = doc.find_all('tr')
    for element in tqdm(elements):
        tds = element.find_all('td')
        url = ""
        save = ""
        for i in range(len(tds)):
            if i == 0:
                save = save_path/(tds[i].text.replace(':', '-').replace('/', '-') + ".zip")
            if i == 1:
                url = tds[i].find('a').get('href')
                break
        
        
        if url != "":
            if not save.exists():
                r = requests.get(url)
                with open(save, 'wb') as f:
                    f.write(r.content)


if __name__ == '__main__':
    main()
    exit(0)